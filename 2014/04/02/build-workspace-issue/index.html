<!doctype html><html lang=en><meta charset=utf-8><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/blog.casavian.eu\/"},"articleSection":"post","name":"Build workspace issue","headline":"Build workspace issue","description":"Notes and considerations of small venetian guy on DevOps tools, architecture, development and other paraphernalia.","inLanguage":"en","author":"Giulio Vian","creator":"Giulio Vian","publisher":"Giulio Vian","accountablePerson":"Giulio Vian","copyrightHolder":"Giulio Vian","copyrightYear":"2014","datePublished":"2014-04-02T00:00:00Z","dateModified":"2014-04-02T00:00:00Z","url":"\/2014\/04\/02\/build-workspace-issue\/","wordCount":"382","keywords":["TFS 2013","TFS 2012","Build","Blog"]}</script><title>Build workspace issue &ndash; Giulio Vian's Blog!</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="Notes and considerations of small venetian guy on DevOps tools, architecture, development and other paraphernalia."><meta name=author content="Giulio Vian"><link rel=icon href=/favicon.ico><meta itemprop=name content="Build workspace issue"><meta itemprop=description content="Some days ago, I got an email from a colleague about a build issue. Here is what she wrote me.
 Hi Giulio,
After bringing back the build agents of ___, we’ve experienced below problem
I’ve mentioned you this problem before, we’ve experienced the same when started to use ____ for first time.
Only deleting the workspaces + physical folders fixed it.
 I know that many Build Master and TFS Administrators have seen the Unable to create the workspace ___ due to a mapping conflict."><meta itemprop=datePublished content="2014-04-02T00:00:00+00:00"><meta itemprop=dateModified content="2014-04-02T00:00:00+00:00"><meta itemprop=wordCount content="382"><meta itemprop=keywords content="TFS 2013,TFS 2012,Build,"><meta property="og:title" content="Build workspace issue"><meta property="og:description" content="Some days ago, I got an email from a colleague about a build issue. Here is what she wrote me.
 Hi Giulio,
After bringing back the build agents of ___, we’ve experienced below problem
I’ve mentioned you this problem before, we’ve experienced the same when started to use ____ for first time.
Only deleting the workspaces + physical folders fixed it.
 I know that many Build Master and TFS Administrators have seen the Unable to create the workspace ___ due to a mapping conflict."><meta property="og:type" content="article"><meta property="og:url" content="http://blog.casavian.eu/2014/04/02/build-workspace-issue/"><meta property="article:published_time" content="2014-04-02T00:00:00+00:00"><meta property="article:modified_time" content="2014-04-02T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Build workspace issue"><meta name=twitter:description content="Some days ago, I got an email from a colleague about a build issue. Here is what she wrote me.
 Hi Giulio,
After bringing back the build agents of ___, we’ve experienced below problem
I’ve mentioned you this problem before, we’ve experienced the same when started to use ____ for first time.
Only deleting the workspaces + physical folders fixed it.
 I know that many Build Master and TFS Administrators have seen the Unable to create the workspace ___ due to a mapping conflict."><meta name=twitter:site content="@giulio_vian"><link rel=alternate href=/index.xml type=application/rss+xml title="Giulio Vian's Blog!"><link rel=stylesheet href=/css/vendor.min.95b0b4c4607aec507f0fc9d9c36a12a4613ccac06f9423caa43e265cb58eb5f90709388cc0fa166ac3ca836b4163e6d0569b8b86065d9cabdf223c5ea9a63b08.css integrity="sha512-lbC0xGB67FB/D8nZw2oSpGE8ysBvlCPKpD4mXLWOtfkHCTiMwPoWasPKg2tBY+bQVpuLhgZdnKvfIjxeqaY7CA=="><link href=http://blog.casavian.eu/css/cookieconsent.min.cd0d0b6e50ff01ff2f3a9a70d7cfb66a7c6cb9acf7a566325568be6d3bd31fc4.css rel=stylesheet type=text/css integrity="sha256-zQ0LblD/Af8vOppw18+2anxsuaz3pWYyVWi+bTvTH8Q=" crossorigin=anonymous><script src=http://blog.casavian.eu/js/cookieconsent.min.e55842a856a6d829feca3c3ad736c136b6c7549e9247274f78aa296259e06e24.js integrity="sha256-5VhCqFam2Cn+yjw61zbBNrbHVJ6SRydPeKopYlngbiQ=" crossorigin=anonymous async></script><script>window.addEventListener("load",function(){window.cookieconsent.initialise({"palette":{"popup":{"background":"#428bca","text":"#ffffff"},"button":{"background":"#f71559"}},"content":{"message":'This website uses cookies.',"dismiss":'Got it!',"link":'Learn more.',"href":"http:\/\/blog.casavian.eu\/page\/privacy-cookies-policy\/"},"position":"bottom-right"})});</script><body><nav class="navbar navbar-light bg-white navbar-expand-lg border-bottom"><div class=container><a class="navbar-brand text-primary" href=/>Giulio Vian's Blog!</a>
<button class="navbar-toggler collapsed" type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="navbar-collapse collapse" id=navbarCollapse><ul class="navbar-nav mr-auto"><li class=nav-item><a class="nav-link text-primary" href=/index.html><i class="fas fa-home"></i>Home</a></li><li class=nav-item><a class="nav-link text-primary" href=/page/about/><i class="fa fa-info-circle"></i>About</a></li><li class=nav-item><a class="nav-link text-primary" href=/page/public-speaking><i class="fa fa-microphone"></i>Speaking</a></li></ul></div></div></nav><main role=main><div class="container mt-3 mb-3"><div class=card><div class=card-body><h1 class=card-title><a href=/2014/04/02/build-workspace-issue/>Build workspace issue</a></h1><h6 class="card-subtitle mb-2 text-muted"><i class="fas fa-calendar-day"></i>&nbsp;02 Apr 2014 -
<i class="fas fa-user"></i>&nbsp;Giulio Vian
- <i class="fas fa-clock"></i>&nbsp;~2 Minutes</h6><p class=card-text><p>Some days ago, I got an email from a colleague about a build issue. Here is what she wrote me.</p><hr><p>Hi Giulio,</p><p>After bringing back the build agents of <code>___</code>, we’ve experienced below problem</p><p><img src=/images/BuildFailure11318.2-sanit_thumb.png alt="BuildFailure11318.2 - sanit"></p><p>I’ve mentioned you this problem before, we’ve experienced the same when started to use <code>____</code> for first time.</p><p>Only deleting the workspaces + physical folders fixed it.</p><hr><p>I know that many Build Master and TFS Administrators have seen the <code>Unable to create the workspace ___ due to a mapping conflict.</code> issue, but it could be useful to review why it happens.</p><p>Workspaces are stored as configuration data in TFS databases, and TFS client forbids having overlapping mappings between different workspaces. So a local (physical) folder, like <code>C:\work</code> on machine <code>MyPC01</code>, cannot belong to more than one workspace.</p><p>After you reconfigure a build server, all “old” workspaces are still recorded in the database, but the Agent Id changes. In the early stages of a build, the workflow creates a workspace to get the source code and the name for this new workspace is generated using the Agent Id (actually <code>$(BuildDefinitionId)_$(BuildAgentId)_$(BuildAgentName)</code> e.g. <code>38_6_Build01</code>). Actually it is smarter, if a workspace with the same name already exists, the found workspace is re-used.</p><p>The workspace mapping is based on Agent working directory, which in that specific case is <code>D:\B\$(BuildDefinitionId)</code>: you see that the mapping has no Agent Id in it.</p><p>So, if the old configuration had a <code>38_6_Build01</code> workspace mapped to <code>D:\B\38</code>, the first run for the rebuilt agent will try to create a workspace <code>38_8_Build01</code> mapped on the same <code>D:\B\38</code> folder, then the error.</p><p><div class="panel panel-warning"><div class=panel-heading><h3 class=panel-title>Caveat</h3></div><div class=panel-body>Using <code>D:\B\$(BuildDefinitionId)</code> as the working directory for Agents is a bad idea.</div></div>In fact the default value is <code>$(SystemDrive)\Builds\$(BuildAgentId)\$(BuildDefinitionPath)</code> which is unique per Build Agent.</p><p>Build Masters have often issues with the length of some paths and they try to squeeze every possible byte, but it is best to educate developers to avoid deep folder structures that incur in the 260 character limit. Discussing in depth this topic requires a full post.</p><p>Another source of problems could be the Build Definition not using the <code>$(SourceDir)</code> macro in the <em>Source Settings</em> tab. In this case the mapping will entirely skip the Agent configuration, so it is up to the Build Master avoiding clashes between different build definitions.</p></p></div><div class=card-footer><small class=text-muted><i class="fas fa-folder text-primary"></i>&nbsp;
<a href=/categories/#alm class="badge badge-primary"><span>ALM</span></a><br><i class="fas fa-tags text-secondary"></i>&nbsp;
<a href=/tags/#tfs-2013 class="badge badge-secondary"><span>TFS 2013</span></a>
<a href=/tags/#tfs-2012 class="badge badge-secondary"><span>TFS 2012</span></a>
<a href=/tags/#build class="badge badge-secondary"><span>Build</span></a></small></div></div></div></main><footer class="navbar-light border-top"><div class=container><div class=row><div class="col-12 col-md-3 mb-3"><h5>Giulio Vian's Blog!</h5>Notes and considerations of small venetian guy on DevOps tools, architecture, development and other paraphernalia.</div><div class="col-12 col-md-3 mb-3"><h5>Social</h5><ul class="list-unstyled list-inline"><li class=list-inline-item><a href=https://github.com/giuliov target=_blank rel="noopener noreferrer" title=GitHub class="fab fa-github fa-2x"></a></li><li class=list-inline-item><a href=https://stackoverflow.com/users/100864 target=_blank rel="noopener noreferrer" title="Stack Overflow" class="fab fa-stack-overflow fa-2x"></a></li><li class=list-inline-item><a href=https://medium.com/@giuliovdev target=_blank rel="noopener noreferrer" title=Medium class="fab fa-medium fa-2x"></a></li><li class=list-inline-item><a href=https://linkedin.com/in/giuliovian target=_blank rel="noopener noreferrer" title=LinkedIn class="fab fa-linkedin fa-2x"></a></li><li class=list-inline-item><a href=https://linkedin.com/company/unum-ireland-ltd-it target=_blank rel="noopener noreferrer" title="LinkedIn Company" class="fab fa-linkedin fa-2x"></a></li><li class=list-inline-item><a href=https://xing.com/profile/Giulio_Vian target=_blank rel="noopener noreferrer" title=Xing class="fab fa-xing fa-2x"></a></li><li class=list-inline-item><a href=https://slideshare.net/giuliov target=_blank rel="noopener noreferrer" title=SlideShare class="fab fa-slideshare fa-2x"></a></li><li class=list-inline-item><a href=https://youtube.com/UCZ-J6JRyvz6aaJ9zCN5wpxA target=_blank rel="noopener noreferrer" title=YouTube class="fab fa-youtube fa-2x"></a></li><li class=list-inline-item><a href=https://twitter.com/giulio_vian target=_blank rel="noopener noreferrer" title=Twitter class="fab fa-twitter fa-2x"></a></li><li class=list-inline-item><a href=mailto:giulio.dev@casavian.eu title=Email class="fas fa-envelope fa-2x"></a></li></ul></div><div class="col-12 col-md-3 mb-3"><h5>Site</h5><ul class=list-unstyled><li><a href=/about/><i class="fas fa-address-card"></i>About</a></li><li><a href=/categories/><i class="fas fa-folder"></i>Categories</a></li><li><a href=/tags/><i class="fas fa-tags"></i>Tags</a></li></ul></div><div class="col-12 col-md-3 mb-3">&copy; 2020 Giulio Vian<br>Theme by <a href=https://www.spech.de target=_blank rel="noopener noreferrer">Sebastian Pech</a>.</div></div></div></footer><script src=/js/vendor.min.0497fa926ed3dc2241b91e016467480841da9749a0f7c40ed3960c3c238745e5accb5ec5e07654668e11047bbf96f95083b88dd49a845781011aba42e4f00a5d.js integrity="sha512-BJf6km7T3CJBuR4BZGdICEHal0mg98QO05YMPCOHReWsy17F4HZUZo4RBHu/lvlQg7iN1JqEV4EBGrpC5PAKXQ=="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-46796059-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>